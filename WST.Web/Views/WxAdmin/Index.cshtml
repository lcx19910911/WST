@using WST.Core.Extensions;
@{
    ViewBag.Title = "扫一扫";
}

@section linkcss
{
    <link rel="stylesheet" href="~/css/SetPreCard.css">
}


<div class="wrap" id="Index">
    <div class="head-div">
        <a href="/user/index"><i></i></a>
        <span>管理员端</span>
        <em>扫一扫</em>
    </div>
    <div class="cont set-pre-card">
        <div class="spc-div">
            <div class="spc-div">
                <div class="spc-radius">
                    <a href="/invite/index" class="spc-item spc-item-card">
                        <div>
                            <strong></strong>
                            <span>邀请码设置</span>
                            <span class="spc-word">Invitation Settings</span>
                        </div>
                    </a>
                @*<a href="/wxadmin/shop" class="spc-item spc-item-obct">
                <div>
                    <strong></strong>
                    <span>购买商品</span>
                    <span class="spc-word">Curriculum Setting</span>
                </div>
            </a>*@ 
                </div>
            </div>
        </div>
    </div>
    <!-- <a href="SetPreCardDiscount.html" class="next-step-btn">下一步</a> -->
</div>

@section scripts
{

    <script src="http://res.wx.qq.com/open/js/jweixin-1.0.0.js" type="text/javascript"></script>
    <script>


        wx.config({
            debug: false, // 开启调试模式,调用的所有api的返回值会在客户端alert出来，若要查看传入的参数，可以在pc端打开，参数信息会通过log打出，仅在pc端时才会打印。
            appId: "@ViewBag.AppId", // 必填，公众号的唯一标识
            timestamp: "@ViewBag.TimeStamp", // 必填，生成签名的时间戳
            nonceStr: "@ViewBag.NonceStr", // 必填，生成签名的随机串
            signature: "@ViewBag.Signature",// 必填，签名，见附录1
            jsApiList: ['jsApiList', 'scanQRCode'] // 必填，需要使用的JS接口列表，所有JS接口列表见附录2
        });
        $(function () {
            // 选择
            $(document).on('click', '.spc-item', function () {
                if (!$(this).hasClass('spc-item-sel')) {
                    $('.spc-item').removeClass('spc-item-sel');
                    $(this).addClass('spc-item-sel');
                }
            });

            $(document).on('click', '.spc-item', function () {
                if (!$(this).hasClass('spc-item-sel')) {
                    $('.spc-item').removeClass('spc-item-sel');
                    $(this).addClass('spc-item-sel');
                }
            });
        })

        wx.ready(function () {
            wx.checkJsApi({
                jsApiList: [
                  'scanQRCode'
                ],
                success: function (res) {
                    if (!IsWeiXin()) {
                        var boxObj1 = BOXOPEN({
                            type: 1,
                            txt: "请在微信中使用"
                        });
                        return false;
                    }
                    $(".head-div em").click(function () {

                        wx.scanQRCode({
                            needResult: 1, // 默认为0，扫描结果由微信处理，1则直接返回扫描结果，
                            success: function (res) { // 当needResult 为 1 时，扫码返回的结果
                                window.location.href = res.resultStr;
                            }
                        });
                    })

                }
            });
        });
    </script>
}